<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title></title>
    <script type='text/javascript' src="http://d3js.org/d3.v3.min.js"></script>
    <script type='text/javascript' src="http://micropolar.org/micropolar-v0.2.2.js"></script>
    <link href="nouislider.min.css" rel="stylesheet">
    <style>

    .chart {display: inline;}

    </style>
</head>
<body>

  <div id="drag-fixed"></div>
  <div class="chart" id="chart-sub-polar1"></div>
  <div class="chart" id="chart-sub-polar2"></div>

  <h3>Move slider handle - on change, fires micropolar chart refresh and passes in random phasor data</h3>

  <script src="nouislider.min.js"></script>

  <script>
  dragFixedSlider = document.getElementById('drag-fixed');
  noUiSlider.create(dragFixedSlider, {
  	start: [ 6 ],
    step: 1,
  	range: {
  		'min':  0,
  		'max':  10
  	},
    pips: {
  	mode: 'steps',
  	density: 7
  }
  });

  dragFixedSlider.noUiSlider.on('update', function(){

  	console.log("slider update fire");
    console.log(this.get());

    function getRandomIntBetweenRange(min, max) {
      return Math.floor(Math.random() * (max - min) + min);
    }

    var t = [118, 1, 240]
    var r = [9, 12, 15]

    var trand = [getRandomIntBetweenRange(100, 140), getRandomIntBetweenRange(0, 10), getRandomIntBetweenRange(210, 250)]
    var rrand = [getRandomIntBetweenRange(8, 12), getRandomIntBetweenRange(8, 12), getRandomIntBetweenRange(11, 16)]
    var colors = ["green"]

    var config = {
      "data": [
      {
        "t": trand,
        "r": rrand,
        "name": "Current Vectors",
        "visible": true,
        "color": colors[getRandomIntBetweenRange(0, (colors.length))],
        "geometry": "DotPlot",
      }],
      "layout": {
        "radialAxis": {
          "domain": [0,20],
          "orientation": -45,
          "visible": true,
          "gridLinesVisible": true,
          "tickOrientation": 'horizontal',
          "ticksSuffix": "mA"
        },
        "angularAxis": {
          "domain": [0,360],
          "visible": true,
          "gridLinesVisible": true,
          "labelsVisible": true,
          "tickOrientation": "horizontal",
          "ticksSuffix": "°"
        },
        "labelOffset": 15,
        "direction": "counterclockwise",
      },

    };
    micropolar.Axis()
      .config(config)
      .render(d3.select('#chart-sub-polar2'));
  });
  </script>

  <script>
  var config = {
    "data": [
    // data for sum current cloud
    {
      "t": [118, 119, 117, 120, 121, 124, 125, 130, 129, 108, 121, 125, 127, 108, 112, 111],
      "r": [9, 12, 15, 10, 8, 7, 8, 10, 9, 10, 11, 12, 14, 15, 14, 12],
      "name": "Current Sum",
      "visible": true,
      "color": "blue",
      "geometry": "DotPlot",
    },
    //data for selected point
    {
      "t": [139],
      "r": [9],
      "name": "Selected Point",
      "visible": true,
      "color": "green",
      "geometry": "DotPlot",
    },
    //data for most recent point
    {
      "t": [138],
      "r": [10],
      "name": "Latest Value",
      "visible": true,
      "color": "orange",
      "geometry": "DotPlot",
    }],
    "layout": {
      "radialAxis": {
        "domain": [0,20],
        "orientation": -45,
        "visible": true,
        "gridLinesVisible": true,
        "tickOrientation": 'horizontal',
        "ticksSuffix": "mA"
      },
      "angularAxis": {
        "domain": [0,360],
        "visible": true,
        "gridLinesVisible": true,
        "labelsVisible": true,
        "tickOrientation": "horizontal",
        "ticksSuffix": "°"
      },
      "labelOffset": 15,
      "direction": "counterclockwise",
    },
  };
  micropolar.Axis()
    .config(config)
    .render(d3.select('#chart-sub-polar1'));
  </script>

  <script>
  var t = [118, 1, 240]
  var r = [9, 12, 15]
  var config = {
    "data": [
    {
      "t": t,
      "r": r,
      "name": "Current Vectors",
      "visible": true,
      "color": "green",
      "geometry": "DotPlot",
    }],
    "layout": {
      "radialAxis": {
        "domain": [0,20],
        "orientation": -45,
        "visible": true,
        "gridLinesVisible": true,
        "tickOrientation": 'horizontal',
        "ticksSuffix": "mA"
      },
      "angularAxis": {
        "domain": [0,360],
        "visible": true,
        "gridLinesVisible": true,
        "labelsVisible": true,
        "tickOrientation": "horizontal",
        "ticksSuffix": "°"
      },
      "labelOffset": 15,
      "direction": "counterclockwise",
    },

  };
  micropolar.Axis()
    .config(config)
    .render(d3.select('#chart-sub-polar2'));
  </script>

</body>
</html>
